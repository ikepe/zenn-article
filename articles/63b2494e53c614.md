---
title: "Mac mini サーバのススメ"
emoji: "🍎"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [macmini]
published: true
---

## はじめに
誰しもが自宅サーバを運用してみたいと思うものですが、そのハードルはかなり高いと思います。最近私が推しているMac miniサーバについて解説していきます。以下が現在運用中のMac miniサーバです。

|  | 名前 | 詳細 |
| ---- | ---- | ---- |
| OS | Proxmox VE |  |
| CPU | Intel i7-3615QM | 4コア8スレッド |
| RAM | DDR3 16GB | 8GB*2 |
| SSD | 1TB | Samsungの何か |
| HDD | 1TB | 元々ついていたやつ |

## 自宅サーバについて
そもそも自宅サーバって何をするのか、VPSではダメなのか？
私が自宅サーバ運営をする理由はロマンです。
もちろんさまざまな勉強になるのも事実ですが、サーバが自宅にあるととても楽しいですよ。

### なぜmac mini 2012にしたのか
まずは、Mac miniを選ぶメリットは
- コンパクトで静音, 省電力
- Apple製という謎の安心感
- リセール価格の高さ

そして2012年モデルをあえて選ぶメリットは
- コスパが良い
- 2.5インチのHDDやSSDを2台搭載できる
- メモリの増設ができる

です。確かに中華のミニPCや、IntelのNUCの方がコンパクトですが、複数台設置するのであれば重ねられるMac miniの方がなんかかっこいいしいいですよね(語彙力)

メルカリで"Mac mini 2012"と検索すると¥13000前後で取引されています。
![](/images/macmini-1.jpeg)
*メルカリでの販売価格*

2014年モデルはメモリの増設、ストレージ交換ができない点、2018年モデルはメモリ増設はできるもののまだまだ値段が高いので2012年モデルが一番コスパが良いと考えています。

### 導入の流れ
私が購入したモデルはi7-3615QM(4コア8スレッド)で、RAMは自力で16GBに増設、ストレージも1TBのSSD、HDDに換装しました。1TBのHDD付で¥15000で購入しました。

ストレージを増設するには専用のケーブルが必要です。ケーブルだけのものや、工具が全て揃っている高級なものまで様々で悩みますが、工具つきで一番安いものを購入しました。今のところ問題なく使えているのでそれで大丈夫だと思います。

https://www.amazon.co.jp/gp/product/B01CXVJ9JG/

:::message alert
上段・下段で色々ややこしいので調べるor一度分解してどっちに載ってるか調べてから購入してください。
:::

分解・増設は以下のサイトを参考にしました。
https://sekinesan.jp/blog/2017/05/23/17203

かなり硬いですが手順通り行えばそこまで難しくないと思います。それよりもマザーボードと電源がとても小さい。感動。

また、OSはProxmox VEという、仮想環境を簡単に構築できるハイパーバイザ型のOSです。このOSについてまだまだ理解が足りていないので詳細は省略しますが、Web GUIで簡単にVMやコンテナを立てることができ、複数サーバ間でマイグレーションやCephという分散ストレージを使用することができます。
Ubuntuなどを使う場合も、特に違いはないので、USBメモリなどでインストールメディアを作成してインストールしてください。

### 追加導入するもの
SSH接続の設定や、IPアドレスの固定などサーバ運用のために必要なことは設定しましょう。また、Mac miniのファンはそのままだと正しく認識してくれないので、macfanctldを使ってcpuファンの設定をしましょう。

以下のコマンドでmacfanctldをインストールするとファンが回り始めます。
```
sudo apt install macfanctld
```

回転数を細かく調整するには、 /etc/macfanctl.conf を編集します。私の設定ファイルは以下のとおりです。
```conf:macfanctl.conf
# Config file for macfanctl daemon
#
# Note: 0 < temp_X_floor < temp_X_ceiling
#       0 < fan_min < 6200

fan_min: 1300

temp_avg_floor: 40
temp_avg_ceiling: 55

temp_TC0P_floor: 40
temp_TC0P_ceiling: 55

temp_TG0P_floor: 40
temp_TG0P_ceiling: 60

# Add sensors to be excluded here, separated by space, i.e.
# exclude: 1 7
# will disable reading of sensors temp1_input and temp7_input.

exclude:

# log_level values:
#   0: Startup / Exit logging only
#   1: Basic temp / fan logging
#   2: Log all sensors

log_level: 0
```
以下のサイトを参考に設定しました
https://qiita.com/zawanume/items/86214295b9c54a5f5b4c

## 導入後の感想
まずは消費電力がとても少ないです。
powertopでの値ですが、負荷がかかっている時でも25w前後、ほとんど使っていない時は5w程度しか使用していません。以前使っていたサーバがとても電気を食っていたので余計に感動しました。
また、とてもコンパクトでそこそこの性能があることも満足しています。現在、マイクラサーバや開発環境などのコンテナをMac miniサーバで走らせていますが、まだまだリソースが余っており、2012年モデルでもまだまだ現役だと感じました。今後Mac miniを買い足す際にも積み上げることができるのも良いと思います。

逆に、不満点は発熱です。想像以上に発熱しており、ファンを止めると本体がかなり熱くなります。cpu温度が50度前後になるようにファンの速度を設定しているのですが、かなり回転しており、近づくと音が気になります。


## 今後の展望
まずは、旧サーバからこのMac miniサーバに移行を完了させたいです。その後、Mac mini 2012(もしくは2018)を購入し、そちらも使ってcephを使ってみたいと考えています。そしてMac miniを積み重ねたいです(重要！)

**初心者にも優しいMac miniサーバ、ぜひ皆さんも！**